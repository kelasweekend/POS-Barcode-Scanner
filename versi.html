<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <link rel="stylesheet" href="assets/css/styles-2.css">
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-7">
                <div class="kiri">
                    <div class="search">
                        <div class="row justify-content-between">
                            <div class="col-md-6 col-6">
                                <div class="d-flex">
                                    <div class="icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none"
                                            viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                        </svg>
                                    </div>
                                    <!-- <p class="cari">Cari Product ...</p> -->
                                    <input type="text" id="search-input" data-search class="cari d-none d-md-block"
                                        placeholder="Kode Product">
                                </div>
                            </div>
                            <div class="col-md-6 col-6">
                                <button class="btn btn-primary btn-desktop btn-mobile" type="button"
                                    id="startScanButton">Barcode</button>
                            </div>
                        </div>
                    </div>

                    <div class="menu">
                        <div class="row" id="list-product">
                            <div class="col-md-4 col-10" data-filter-item data-kode="8209701751927">
                                <div class="card p-3 add-to-cart" data-id="1" data-name="Produk 1" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="8999999572693">
                                <div class="card p-3 add-to-cart" data-id="2" data-name="Produk 2" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="8995757107015">
                                <div class="card p-3 add-to-cart" data-id="3" data-name="Produk 3" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="ASDQSAX">
                                <div class="card p-3 add-to-cart" data-id="4" data-name="Produk 4" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="ASDQSAX">
                                <div class="card p-3 add-to-cart" data-id="5" data-name="Produk 5" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="ASDQSAX">
                                <div class="card p-3 add-to-cart" data-id="6" data-name="Produk 6" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="ASDQSAX">
                                <div class="card p-3 add-to-cart" data-id="7" data-name="Produk 7" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="ASDQSAX">
                                <div class="card p-3 add-to-cart" data-id="8" data-name="Produk 8" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                            <div class="col-md-4 col-10" data-filter-item data-kode="ASDQSAX">
                                <div class="card p-3 add-to-cart" data-id="9" data-name="Produk 9" data-price="10">
                                    <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                        alt="">
                                    <p class="mb-2">NOKA Perfume - Bloom</p>
                                    <p class="mb-2">Rp. 50.000</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-5">
                <div class="kanan">
                    <div class="text-center empty">
                        <div class="kosong">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 inline-block" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
                                </path>
                            </svg>
                            <p class="mt-0">Order Empty</p>
                        </div>
                    </div>

                    <div class="isi d-none">
                        <div class="d-flex justify-content-between">
                            <div class="d-flex">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 inline-block" fill="none"
                                    viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z">
                                    </path>
                                </svg>
                                <p class="fw-bold text-muted ms-1" id="product-count">0 Item</p>
                            </div>
                            <svg class="delete clear-cart" xmlns="http://www.w3.org/2000/svg"
                                class="h-6 w-6 inline-block" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16">
                                </path>
                            </svg>
                        </div>
                        <div class="over" id="cart-items">
                            <!-- keranjang -->
                        </div>
                    </div>

                    <div class="harga">
                        <div class="d-flex justify-content-between">
                            <p>Total</p>
                            <p id="total">Rp. 0</p>
                        </div>
                    </div>

                    <div class="cazh p-3">
                        <div class="d-flex justify-content-between">
                            <p class="mb-0">UANG</p>
                            <div class="d-flex mb-0">
                                <p>Rp. </p>
                                <input type="number" class="form-controll" value="" id="cash-input">
                            </div>
                        </div>
                    </div>

                    <div class="alert alert-primary rounded-20 mt-3" role="alert">
                        <div class="d-flex justify-content-between">
                            <p class="mb-0">KEMBALI</p>
                            <p class="mb-0" id="change"></p>
                        </div>
                    </div>

                    <button class="btn btn-primary w-100 rounded-20" id="print-cart">Bayar Sekarang</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-notif p-5 text-center">
                <div id="qr-reader"></div>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content modal-notif p-3">
                <div class="row">
                    <div class="col-md-6">
                        <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                            class="img-fluid rounded-20" alt="">
                    </div>
                    <div class="col-md-6">
                        <div class="desc">
                            <h3>Product 1</h3>
                            <p>Rp 10.000</p>
                            <p>Stok Tersisa : 10</p>
                        </div>
                        <button type="button" class="btn btn-primary w-100 rounded-15 b1" data-id="1"
                            data-name="Produk 1" data-price="10">To Cart</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"
        integrity="sha512-r6rDA7W6ZeQhvl8S7yRVQUKVHdexq+GAlNkNNqVC7YyIV+NwqCTJe2hDWCiffTyRNOeGEzRRJ9ifvRm/HCzGYg=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            let html5QrcodeScanner;

            $("#startScanButton").click(function () {
                $("#exampleModal").modal('show');
                html5QrcodeScanner = new Html5QrcodeScanner(
                    "qr-reader", { fps: 10, qrbox: 200 });

                html5QrcodeScanner.render(onScanSuccess);
            });

            function onScanSuccess(decodedText, decodedResult) {
                $("#result").text("Barcode Result: " + decodedText);
                html5QrcodeScanner.clear();
                html5QrcodeScanner.render(onScanSuccess);
                $("#exampleModal").modal('hide');

                // Produk-data yang dihubungkan dengan barcode
                let products = [
                    {
                        barcode: "123456789",
                        name: "Product 1",
                        price: "$10",
                        description: "Lorem ipsum dolor sit amet, consectetur adipiscing elit."
                    },
                    {
                        barcode: "987654321",
                        name: "Product 2",
                        price: "$15",
                        description: "Nulla vitae elit libero, a pharetra augue."
                    },
                    {
                        barcode: "8993988286059",
                        name: "Product 3",
                        price: "$20",
                        description: "Pellentesque ornare sem lacinia quam venenatis vestibulum."
                    }
                ];

                // Pencocokan barcode dengan produk
                let product = products.find(function (product) {
                    return product.barcode === decodedText;
                });

                if (product) {
                    $("#product-name").text("Name: " + product.name);
                    $("#product-price").text("Price: " + product.price);
                    $("#product-description").text("Description: " + product.description);
                    $("#productModal").modal('show');
                } else {
                    $("#productModal").modal('hide');
                }
            }
        });
    </script>

    <script type="text/javascript">
        $(document).ready(function () {
            var cartItems = [];
            var total = 0;

            // Hapus semua produk dari keranjang
            function clearCart() {
                cart = [];
                total = 0;
                updateCart();
            }

            function updateCart() {
                $('#cart-items').empty();
                $('#product-count').text(cartItems.length + ' Item');

                if (cartItems.length == 0) {
                    $('.empty').removeClass('d-none');
                    $('.isi').addClass('d-none');
                }

                for (var i = 0; i < cartItems.length; i++) {
                    var item = cartItems[i];
                    var itemTotal = item.price * item.quantity;

                    var appendCard = `<li>
                        <div class="card p-2">
                            <div class="d-flex justify-content-between">
                                <div class="d-flex">
                                    <div class="thumbnail">
                                        <img src="https://images.soco.id/362-Parfum-dengan-Aroma-Vanilla-100-Ribu.jpg.jpeg"
                                            width="40" height="40" alt="">
                                    </div>
                                    <div class="list">
                                        <p>`+ item.name + `</p>
                                        <small>Rp `+ parseInt(itemTotal).toLocaleString() + `</small>
                                    </div>
                                </div>

                                <div class="jumlah">
                                    <button class="btn btn-secondary qty-button kurang" data-index="` + i + `">-</button>
                                    <div class="angka">
                                       `+ item.quantity + `
                                    </div>
                                    <button class="btn btn-secondary qty-button tambah" data-index="` + i + `">+</button>
                                </div>
                            </div>
                        </div>
                    </li>`;
                    $('#cart-items').append(appendCard);
                }

                $('#total').text(total);

                // Menghitung dan menampilkan kembalian
                var cashInput = $('#cash-input').val();
                var change = cashInput - total;
                if (change >= 0) {
                    $('#change').text(change);
                } else {
                    $('#change').text("-");
                }
            }

            function addItemToCart(id, name, price) {
                for (var i = 0; i < cartItems.length; i++) {
                    if (cartItems[i].id === id) {
                        cartItems[i].quantity++;
                        total += price;
                        updateCart();
                        return;
                    }
                }

                var newItem = {
                    id: id,
                    name: name,
                    price: price,
                    quantity: 1
                };

                cartItems.push(newItem);
                total += price;
                updateCart();

                $('.empty').addClass('d-none');
                $('.isi').removeClass('d-none');
            }

            // Tambahkan produk ke keranjang belanja
            $('.add-to-cart').click(function () {
                var id = $(this).data('id');
                var name = $(this).data('name');
                var price = $(this).data('price');

                addItemToCart(id, name, price);
            });

            // Kurangi jumlah produk di keranjang belanja
            $('#cart-items').on('click', '.kurang', function () {
                var index = $(this).data('index');
                var item = cartItems[index];

                if (item.quantity > 1) {
                    item.quantity--;
                    total -= item.price;
                } else {
                    cartItems.splice(index, 1);
                    total -= item.price;
                }

                updateCart();
            });

            // Ketika tombol "Hapus Semua" diklik, hapus semua produk dari keranjang
            $('.clear-cart').on('click', function () {
                clearCart();
                $('.empty').removeClass('d-none');
                $('.isi').addClass('d-none');
            });

            // Tambahkan jumlah produk di keranjang belanja
            $('#cart-items').on('click', '.tambah', function () {
                var index = $(this).data('index');
                var item = cartItems[index];

                item.quantity++;
                total += item.price;

                updateCart();
            });

            $('.b1').on('click', function () {
                var id = $(this).data('id');
                var name = $(this).data('name');
                var price = $(this).data('price');

                addItemToCart(id, name, price);
                $("#productModal").modal('hide');
            });

            // Update kembalian saat input uang cash berubah
            $('#cash-input').on('input', function () {
                updateCart();
            });
        });
    </script>
</body>

</html>